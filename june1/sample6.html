<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <ul></ul>
    <script>
        var user=[]
        
        function postdatatoServer(){
            var postdata = new XMLHttpRequest;
            postdata.onreadystate = function(){
                if(postdata.readyState==4 && postdata.status == 201){
                    console.log("data posted successfully")
                }
            }
            postdata.open("POST","http://localhost:3000/users");
            postdata.setRequestHeader("content-type","applicant/json");
            postdata.send(JSON.stringify(user));
        }


        function gettingDataFromServer() { 
            var getData = new XMLHttpRequest();
            getData.onreadystatechange = function () {
                if (getData.readyState == 4 && getData.status == 200) {
                    users = JSON.parse(getData.response)
                    displayAllUsers(users)
                }
            }
            getData.open("GET", "http://localhost:3000/users")
            getData.send()

        }
        function deleteDataFromServer(users){
            var deleteData =  new XMLHttpRequest();
            deleteData.onreadystatechange = function(){
                if(deleteData.readyState == 4 && deleteData.status == 200){
                   users= JSON.parse(deleteData.response)
                   displayAllUsers(users)
                    console.log("data deleted successfully")
                }
            }
            deleteData.open("DELETE","http://localhost:3000/users/"+ users.id);
            deleteData.send()
            
        }

        function editUser(i){
            console.log(i)
        }
        function displayAllUsers(users) {
            document.querySelector("ul").innerHTML = ""
            users.forEach((user, i) => {
                var li = document.createElement("li")
                li.innerHTML = user.fname + " <button onclick='editUser(" + i + ")'>Edit</button><button onclick='deleteUser(" + users.id + ")'>Delete</button>"
                document.querySelector("ul").appendChild(li)
            })
        }

        gettingDataFromServer(displayAllUsers)
    </script>
</body>
</html>